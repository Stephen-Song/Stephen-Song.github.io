(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{493:function(t,s,a){"use strict";a.r(s);var n=a(26),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"如何根据chrome的timing优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何根据chrome的timing优化"}},[t._v("#")]),t._v(" 如何根据"),a("code",[t._v("chrome")]),t._v("的"),a("code",[t._v("timing")]),t._v("优化"),a("badge",{attrs:{text:"重要",type:"warning"}})],1),t._v(" "),a("p",[a("strong",[t._v("性能优化"),a("code",[t._v("API")])])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("Performance")]),t._v("。"),a("code",[t._v("performance.now()")]),t._v("与"),a("code",[t._v("new Date()")]),t._v("区别，它是高精度的，且是相对时间，相对于页面加载的那一刻。但是不一定适合单页面场景")]),t._v(" "),a("li",[a("code",[t._v('window.addEventListener("load", "");')]),t._v(" "),a("code",[t._v('window.addEventListener("domContentLoaded", "");')])]),t._v(" "),a("li",[a("code",[t._v("Img")]),t._v("的"),a("code",[t._v("onload")]),t._v("事件，监听首屏内的图片是否加载完成，判断首屏事件")]),t._v(" "),a("li",[a("code",[t._v("RequestAnmationFrame")]),t._v(" 和 "),a("code",[t._v("RequestIdleCallback")])]),t._v(" "),a("li",[a("code",[t._v("IntersectionObserver")]),t._v("、"),a("code",[t._v("MutationObserver")]),t._v("，"),a("code",[t._v("PostMessage")])]),t._v(" "),a("li",[a("code",[t._v("Web Worker")]),t._v("，耗时任务放在里面执行")])]),t._v(" "),a("p",[a("strong",[t._v("检测工具")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("Chrome Dev Tools")])]),t._v(" "),a("li",[a("code",[t._v("Page Speed")])]),t._v(" "),a("li",[a("code",[t._v("Jspref")])])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/duochizhacai/generatePic/img/202201101123827.png",alt:""}})]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onload")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" t "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" performance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("timing\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DNS查询耗时 ：'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("domainLookupEnd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("domainLookupStart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toFixed")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'TCP链接耗时 ：'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("connectEnd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("connectStart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toFixed")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'request请求耗时 ：'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseEnd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseStart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toFixed")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'解析dom树耗时 ：'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("domComplete "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("domInteractive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toFixed")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'白屏时间 ：'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseStart "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("navigationStart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toFixed")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'domready时间 ：'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("domContentLoadedEventEnd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("navigationStart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toFixed")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'onload时间 ：'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("loadEventEnd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("navigationStart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toFixed")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" performance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memory"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'js内存使用占比 ：'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("usedJSHeapSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("totalJSHeapSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toFixed")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'%'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br")])]),a("h2",{attrs:{id:"懒加载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#懒加载"}},[t._v("#")]),t._v(" 懒加载")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("概念：")]),t._v(" "),a("p",[t._v("懒加载也叫做延迟加载、按需加载，指的是在长网页中延迟加载图片数据，是一种较好的网页性能优化的方式。在比较长的网页或应用中，如果图片很多，所有的图片都被加载出来，而用户只能看到可视窗口的那一部分图片数据，这样就浪费了性能")])]),t._v(" "),a("p",[t._v("如果使用图片的懒加载就可以解决以上问题。在滚动屏幕之前，可视化区域之外的图片不会进行加载，在滚动屏幕时才加载。这样使得网页的加载速度更快，减少了服务器的负载。懒加载适用于图片较多，页面列表较长（长列表）的场景中。")]),t._v(" "),a("p",[a("strong",[t._v("特点：")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("减少无用资源的加载，减少服务器的压力和流量")])]),t._v(" "),a("li",[a("p",[t._v("提升用户体验，减少用户等待时间")])]),t._v(" "),a("li",[a("p",[t._v("防止加载过多图片而影响其他资源文件的加载")])])]),t._v(" "),a("p",[t._v("实现原理：")]),t._v(" "),a("p",[t._v("图片的加载是由 "),a("strong",[a("code",[t._v("src")]),a("strong",[t._v("引起的，当对")]),a("code",[t._v("src")])]),t._v(" 赋值时，浏览器就会请求图片资源。根据这个原理，我们使用"),a("code",[t._v("HTML5")]),t._v(" 的 "),a("strong",[a("code",[t._v("data-xxx")]),a("strong",[t._v("属性来储存图片的路径，在需要加载图片的时候，将")]),a("code",[t._v("data-xxx")]),a("strong",[t._v("中图片的路径赋值给")]),a("code",[t._v("src")])]),t._v("，这样就实现了图片的按需加载，即懒加载。")]),t._v(" "),a("p",[t._v("注意："),a("strong",[a("code",[t._v("data-xxx")])]),t._v(" 中的 "),a("strong",[a("code",[t._v("xxx")])]),t._v(" 可以自定义，这里我们使用 "),a("strong",[a("code",[t._v("data-src")])]),t._v(" 来定义。")]),t._v(" "),a("p",[t._v("懒加载的实现重点在于确定用户需要加载哪张图片，在浏览器中，可视区域内的资源就是用户需要的资源。所以当图片出现在可视区域时，获取图片的真实地址并赋值给图片即可。")]),t._v(" "),a("p",[t._v("使用原生"),a("code",[t._v("JavaScript")]),t._v("实现懒加载：")]),t._v(" "),a("p",[a("strong",[t._v("知识点：")])]),t._v(" "),a("p",[t._v("（1）"),a("strong",[a("code",[t._v("window.innerHeight")])]),t._v(" 是浏览器可视区的高度")]),t._v(" "),a("p",[t._v("（2）"),a("strong",[a("code",[t._v("document.body.scrollTop || document.documentElement.scrollTop")])]),t._v(" 是浏览器滚动的过的距离")]),t._v(" "),a("p",[t._v("（3）"),a("strong",[a("code",[t._v("imgs.offsetTop")])]),t._v(" 是元素顶部距离文档顶部的高度（包括滚动条的距离）")]),t._v(" "),a("p",[t._v("（4）图片加载条件："),a("strong",[a("code",[t._v("img.offsetTop < window.innerHeight + document.body.scrollTop")])])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/duochizhacai/generatePic/img/202112181706075.png",alt:"img"}})]),t._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"container"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("img src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"loading.gif"')]),t._v("  data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pic.png"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("img src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"loading.gif"')]),t._v("  data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pic.png"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("img src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"loading.gif"')]),t._v("  data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pic.png"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("img src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"loading.gif"')]),t._v("  data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pic.png"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("img src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"loading.gif"')]),t._v("  data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pic.png"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("img src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"loading.gif"')]),t._v("  data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pic.png"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" imgs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("querySelectorAll")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'img'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("lozyLoad")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" scrollTop "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scrollTop "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("documentElement"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scrollTop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" winHeight"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHeight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" imgs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("imgs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offsetTop "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" scrollTop "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" winHeight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\timgs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" imgs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAttribute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data-src'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onscroll "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("lozyLoad")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br")])]),a("h2",{attrs:{id:"懒加载和预加载的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#懒加载和预加载的区别"}},[t._v("#")]),t._v(" 懒加载和预加载的区别")]),t._v(" "),a("p",[t._v("这两种方式都是提高网页性能的方式，两者主要区别是一个是提前加载，一个是迟缓甚至不加载。懒加载对服务器前端有一定的缓解压力作用，预加载则会增加服务器前端压力。")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("懒加载也叫延迟加载，指的是在长网页中延迟加载图片的时机，当用户需要访问时，再去加载")]),t._v("，这样可以提高网站的首屏加载速度，提升用户的体验，并且可以减少服务器的压力。它适用于图片很多，页面很长的电商网站的场景。懒加载的实现原理是，将页面上的图片的 "),a("code",[t._v("src")]),t._v(" 属性设置为空字符串，将图片的真实路径保存在一个自定义属性中，当页面滚动的时候，进行判断，如果图片进入页面可视区域内，则从自定义属性中取出真实路径赋值给图片的 "),a("code",[t._v("src")]),t._v(" 属性，以此来实现图片的延迟加载。")]),t._v(" "),a("li",[a("strong",[t._v("预加载指的是将所需的资源提前请求加载到本地，这样后面在需要用到时就直接从缓存取资源。")]),t._v(" 通过预加载能够减少用户的等待时间，提高用户的体验。我了解的预加载的最常用的方式是使用 "),a("code",[t._v("js")]),t._v(" 中的 "),a("code",[t._v("image")]),t._v(" 对象，通过为 "),a("code",[t._v("image")]),t._v(" 对象来设置 "),a("code",[t._v("src")]),t._v(" 属性，来实现图片的预加载。")])]),t._v(" "),a("h2",{attrs:{id:"link标签的预处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#link标签的预处理"}},[t._v("#")]),t._v(" "),a("code",[t._v("link")]),t._v("标签的预处理"),a("badge",{attrs:{text:"重要",type:"warning"}})],1),t._v(" "),a("p",[a("code",[t._v("dns-prefetch")]),t._v("。当 "),a("code",[t._v("link")]),t._v(" 标签的 "),a("code",[t._v("rel")]),t._v(" 属性值为“"),a("code",[t._v("dns-prefetch")]),t._v("”时，"),a("code",[t._v("浏览器会对某个域名预先进行 DNS 解析并缓存")]),t._v("。这样，当浏览器在请求同域名资源的时候，能省去从域名查询 "),a("code",[t._v("IP")]),t._v(" 的过程，从而"),a("code",[t._v("减少时间损耗")]),t._v("。下图是淘宝网设置的 "),a("code",[t._v("DNS")]),t._v(" 预解析")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/duochizhacai/generatePic/img/202201071812835.png",alt:""}})]),t._v(" "),a("ul",[a("li",[a("code",[t._v("preconnect")]),t._v("。让浏览器在一个 "),a("code",[t._v("HTTP")]),t._v(" 请求正式发给服务器前预先执行一些操作，这包括"),a("code",[t._v("DNS 解析、TLS 协商、TCP 握手")]),t._v("，通过消除往返延迟来为用户节省时间")]),t._v(" "),a("li",[a("code",[t._v("prefetch/preload")]),t._v("。两个值都是"),a("code",[t._v("让浏览器预先下载并缓存某个资源")]),t._v("，但不同的是，"),a("code",[t._v("prefetch 可能会在浏览器忙时被忽略")]),t._v("，而 "),a("code",[t._v("preload 则是一定会被预先下载")]),t._v("。")]),t._v(" "),a("li",[a("code",[t._v("prerender")]),t._v("。浏览器不仅会加载资源，还会解析执行页面，进行预渲染")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/duochizhacai/generatePic/img/202201071815371.png",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"介绍一下什么是回流和重绘"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#介绍一下什么是回流和重绘"}},[t._v("#")]),t._v(" 介绍一下什么是回流和重绘"),a("badge",{attrs:{text:"特别重要",type:"error"}})],1),t._v(" "),a("p",[a("strong",[t._v("回流")])]),t._v(" "),a("p",[t._v("当渲染树中部分或者全部元素的尺寸、结构或者属性发生变化时，浏览器会重新渲染部分或者全部文档的过程就称为"),a("strong",[t._v("回流")]),t._v("。")]),t._v(" "),a("p",[t._v("下面这些操作会导致回流：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("页面的首次渲染")])]),t._v(" "),a("li",[a("p",[t._v("浏览器的窗口大小发生变化")])]),t._v(" "),a("li",[a("p",[t._v("元素的内容发生变化")])]),t._v(" "),a("li",[a("p",[t._v("元素的尺寸或者位置发生变化")])]),t._v(" "),a("li",[a("p",[t._v("元素的字体大小发生变化")])]),t._v(" "),a("li",[a("p",[t._v("激活"),a("code",[t._v("CSS")]),t._v("伪类")])]),t._v(" "),a("li",[a("p",[t._v("查询某些属性或者调用某些方法")])]),t._v(" "),a("li",[a("p",[t._v("添加或者删除可见的"),a("code",[t._v("DOM")]),t._v("元素")])])]),t._v(" "),a("p",[t._v("在触发回流（重排）的时候，由于浏览器渲染页面是基于"),a("strong",[t._v("流式布局")]),t._v("的，所以当触发回流时，会导致周围的"),a("code",[t._v("DOM")]),t._v("元素重新排列，它的影响范围有两种：")]),t._v(" "),a("ul",[a("li",[t._v("全局范围：从根节点开始，对整个渲染树进行重新布局")]),t._v(" "),a("li",[t._v("局部范围：对渲染树的某部分或者一个渲染对象进行重新布局")])]),t._v(" "),a("p",[a("strong",[t._v("重绘")])]),t._v(" "),a("p",[t._v("当页面中某些元素的样式发生变化，但是不会影响其在文档流中的位置时，浏览器就会对元素进行重新绘制，这个过程就是"),a("strong",[t._v("重绘")]),t._v("。")]),t._v(" "),a("p",[t._v("下面这些操作会导致回流：")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("color")]),t._v("、"),a("code",[t._v("background")]),t._v(" 相关属性："),a("code",[t._v("background-color")]),t._v("、"),a("code",[t._v("background-image")]),t._v(" 等")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("outline")]),t._v(" 相关属性："),a("code",[t._v("outline-color")]),t._v("、"),a("code",[t._v("outline-width")]),t._v(" 、"),a("code",[t._v("text-decoration")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("border-radius")]),t._v("、"),a("code",[t._v("visibility")]),t._v("、"),a("code",[t._v("box-shadow")])])])]),t._v(" "),a("p",[t._v("注意： "),a("strong",[t._v("当触发回流时，一定会触发重绘，但是重绘不一定会引发回流。")])]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("什么是流式布局")]),t._v(" "),a("p",[t._v("页面元素的宽度按照屏幕分辨率进行适配调整，但整体布局不变。通常宽度是以"),a("code",[t._v("%")]),t._v("来表示，但是设置了最大宽度"),a("code",[t._v("max-width")]),t._v("和最小宽度"),a("code",[t._v("min-width")]),t._v(",分辨率发生变化的话元素大小会变，但是整体布局不变，缺点很明显是屏幕尺寸跨度大不能正常显示出来(页面元素被拉得很长，但是高度和文字大小不变)")])]),t._v(" "),a("h2",{attrs:{id:"如何避免回流和重绘"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何避免回流和重绘"}},[t._v("#")]),t._v(" 如何避免回流和重绘"),a("badge",{attrs:{text:"重要",type:"warning"}})],1),t._v(" "),a("p",[a("strong",[t._v("减少回流与重绘的措施：")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("操作"),a("code",[t._v("DOM")]),t._v("时，尽量在低层级的"),a("code",[t._v("DOM")]),t._v("节点进行操作")])]),t._v(" "),a("li",[a("p",[t._v("不要使用 "),a("strong",[a("code",[t._v("table")])]),t._v(" 布局， 一个小的改动可能会使整个 "),a("strong",[a("code",[t._v("table")])]),t._v(" 进行重新布局")])]),t._v(" "),a("li",[a("p",[t._v("使用"),a("code",[t._v("CSS")]),t._v("的表达式")])]),t._v(" "),a("li",[a("p",[t._v("不要频繁操作元素的样式，对于静态页面，可以修改类名，而不是样式。")])]),t._v(" "),a("li",[a("p",[t._v("使用"),a("code",[t._v("absolute")]),t._v("或者"),a("code",[t._v("fixed")]),t._v("，使元素脱离文档流，这样他们发生变化就不会影响其他元素")])]),t._v(" "),a("li",[a("p",[t._v("避免频繁操作"),a("code",[t._v("DOM")]),t._v("，可以创建一个文档片段 "),a("strong",[a("code",[t._v("documentFragment")])]),t._v(" ，在它上面应用所有"),a("code",[t._v("DOM")]),t._v("操作，最后再把它添加到文档中")])]),t._v(" "),a("li",[a("p",[t._v("将元素先设置 "),a("strong",[a("code",[t._v("display: none")])]),t._v(" ，操作结束后再把它显示出来。因为在"),a("code",[t._v("display")]),t._v("属性为"),a("code",[t._v("none")]),t._v("的元素上进行的"),a("code",[t._v("DOM")]),t._v("操作不会引发回流和重绘。")])]),t._v(" "),a("li",[a("p",[t._v("将"),a("code",[t._v("DOM")]),t._v("的多个读操作（或者写操作）放在一起，而不是读写操作穿插着写。这得益于"),a("strong",[t._v("浏览器的渲染队列机制")]),t._v("。")])])]),t._v(" "),a("p",[t._v("浏览器针对页面的回流与重绘，进行了自身的优化——"),a("strong",[t._v("渲染队列")])]),t._v(" "),a("p",[a("strong",[t._v("浏览器会将所有的回流、重绘的操作放在一个队列中，当队列中的操作到了一定的数量或者到了一定的时间间隔，浏览器就会对队列进行批处理。这样就会让多次的回流、重绘变成一次回流重绘。")])]),t._v(" "),a("p",[t._v("上面，将多个读操作（或者写操作）放在一起，就会等所有的读操作进入队列之后执行，这样，原本应该是触发多次回流，变成了只触发一次回流。")]),t._v(" "),a("h2",{attrs:{id:"如何优化动画"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何优化动画"}},[t._v("#")]),t._v(" 如何优化动画")]),t._v(" "),a("p",[t._v("对于如何优化动画，我们知道，一般情况下，动画需要频繁的操作"),a("code",[t._v("DOM")]),t._v("，就就会导致页面的性能问题，我们可以将动画的 "),a("strong",[a("code",[t._v("position")])]),t._v(" 属性设置为 "),a("strong",[a("code",[t._v("absolute")])]),t._v(" 或者 "),a("strong",[a("code",[t._v("fixed")])]),t._v(" ，将动画脱离文档流，这样他的回流就不会影响到页面了。")]),t._v(" "),a("h2",{attrs:{id:"documentfragment是什么-用它跟直接操作dom有什么区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#documentfragment是什么-用它跟直接操作dom有什么区别"}},[t._v("#")]),t._v(" "),a("code",[t._v("documentFragment")]),t._v("是什么？用它跟直接操作"),a("code",[t._v("dom")]),t._v("有什么区别"),a("badge",{attrs:{text:"重要",type:"warning"}})],1),t._v(" "),a("div",{staticClass:"custom-block theorem"},[a("p",{staticClass:"title"},[t._v("概念")]),a("p",[a("code",[t._v("DocumentFragment")]),t._v("，文档片段接口，一个没有父对象的最小文档对象。它被作为一个轻量版的 "),a("code",[t._v("Document")]),t._v("使用，就像标准的"),a("code",[t._v("document")]),t._v("一样，存储由节点（"),a("code",[t._v("nodes")]),t._v("）组成的文档结构。与"),a("code",[t._v("document")]),t._v("相比，最大的区别是"),a("code",[t._v("DocumentFragment")]),a("strong",[t._v("不是真实 "),a("code",[t._v("DOM")]),t._v(" 树的一部分")]),t._v("，它的变化不会触发 "),a("code",[t._v("DOM")]),t._v(" 树的重新渲染，且不会导致性能等问题。")]),t._v(" "),a("div",{staticClass:"custom-block right"},[a("p",[a("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/DocumentFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("MDN"),a("OutboundLink")],1)])])]),a("p",[t._v("当我们把一个 "),a("code",[t._v("DocumentFragment")]),t._v(" 节点插入文档树时，插入的不是 "),a("code",[t._v("DocumentFragment")]),t._v(" 自身，他只是相当于一个占位符，而是它的所有子孙节点。在频繁的"),a("code",[t._v("DOM")]),t._v("操作时，我们就可以将"),a("code",[t._v("DOM")]),t._v("元素插入"),a("code",[t._v("DocumentFragment")]),t._v("，之后一次性的将所有的子孙节点插入文档中。和直接操作"),a("code",[t._v("DOM")]),t._v("相比，将"),a("code",[t._v("DocumentFragment")]),t._v(" 节点插入"),a("code",[t._v("DOM")]),t._v("树时，不会引起"),a("code",[t._v("DOM")]),t._v("树的重新渲染("),a("code",[t._v("reflow")]),t._v("),从而减少回流(一次"),a("code",[t._v("append")]),t._v("只回流一次)")]),t._v(" "),a("h2",{attrs:{id:"介绍一下防抖和节流"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#介绍一下防抖和节流"}},[t._v("#")]),t._v(" 介绍一下防抖和节流"),a("badge",{attrs:{text:"重要",type:"warning"}})],1),t._v(" "),a("ul",[a("li",[t._v("函数防抖是指在事件被触发 "),a("code",[t._v("n")]),t._v(" 秒后再执行回调，如果在这 "),a("code",[t._v("n")]),t._v(" 秒内事件又被触发，则重新计时。这可以使用在一些点击请求的事件上，避免因为用户的多次点击向后端发送多次请求。")]),t._v(" "),a("li",[t._v("函数节流是指规定一个单位时间，在这个单位时间内，只能有一次触发事件的回调函数执行，如果在同一个单位时间内某事件被触发多次，只有一次能生效。节流可以使用在 "),a("code",[t._v("scroll")]),t._v(" 函数的事件监听上，通过事件节流来降低事件调用的频率")])]),t._v(" "),a("p",[a("strong",[t._v("防抖函数的应用场景：")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("按钮提交场景：防⽌多次提交按钮，只执⾏最后提交的⼀次")])]),t._v(" "),a("li",[a("p",[t._v("服务端验证场景：表单验证需要服务端配合，只执⾏⼀段连续的输⼊事件的最后⼀次，还有搜索联想词功能类似⽣存环境请⽤"),a("code",[t._v("lodash.debounce")])])])]),t._v(" "),a("p",[a("strong",[t._v("节流函数的适⽤场景：")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("拖拽场景：固定时间内只执⾏⼀次，防⽌超⾼频次触发位置变动")])]),t._v(" "),a("li",[a("p",[t._v("缩放场景：监控浏览器"),a("code",[t._v("resize")])])]),t._v(" "),a("li",[a("p",[t._v("动画场景：避免短时间内多次触发动画引起性能问题")])])]),t._v(" "),a("h2",{attrs:{id:"图片优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#图片优化"}},[t._v("#")]),t._v(" 图片优化")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("不用图片。很多时候会使用到很多修饰类图片，其实这类修饰图片完全可以用 "),a("code",[t._v("CSS")]),t._v(" 去代替。")])]),t._v(" "),a("li",[a("p",[t._v("对于移动端来说，屏幕宽度就那么点，完全没有必要去加载原图浪费带宽。一般图片都用 "),a("code",[t._v("CDN")]),t._v(" 加载，可以计算出适配屏幕的宽度，然后去请求相应裁剪好的图片。")])]),t._v(" "),a("li",[a("p",[t._v("小图使用 "),a("code",[t._v("base64")]),t._v(" 格式")])]),t._v(" "),a("li",[a("p",[t._v("将多个图标文件整合到一张图片中（雪碧图）")])]),t._v(" "),a("li",[a("p",[t._v("选择正确的图片格式：")]),t._v(" "),a("ul",[a("li",[t._v("对于能够显示 "),a("code",[t._v("WebP")]),t._v(" 格式的浏览器尽量使用 "),a("code",[t._v("WebP")]),t._v(" 格式。因为 "),a("code",[t._v("WebP")]),t._v(" 格式具有更好的图像数据压缩算法，能带来更小的图片体积，而且拥有肉眼识别无差异的图像质量，缺点就是兼容性并不好")]),t._v(" "),a("li",[t._v("小图使用 "),a("code",[t._v("PNG")]),t._v("，其实对于大部分图标这类图片，完全可以使用 "),a("code",[t._v("SVG")]),t._v(" 代替")]),t._v(" "),a("li",[t._v("照片使用 "),a("code",[t._v("JPEG")])])])])]),t._v(" "),a("h2",{attrs:{id:"移动端优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#移动端优化"}},[t._v("#")]),t._v(" 移动端优化")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/duochizhacai/generatePic/img/202201101127391.png",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"面试回答性能优化怎么显得有条理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#面试回答性能优化怎么显得有条理"}},[t._v("#")]),t._v(" 面试回答性能优化怎么显得有条理")]),t._v(" "),a("p",[a("strong",[t._v("分点作答")])]),t._v(" "),a("p",[a("mark",[t._v("让文件加载更快")])]),t._v(" "),a("ul",[a("li",[t._v("让传输的数据包更小（压缩文件/图片）：图片压缩和文件压缩")]),t._v(" "),a("li",[t._v("减少网络请求的次数：雪碧图/精灵图、节流防抖")]),t._v(" "),a("li",[t._v("减少渲染的次数：缓存（"),a("code",[t._v("HTTP")]),t._v("缓存、本地缓存、"),a("code",[t._v("Vue")]),t._v("的"),a("code",[t._v("keep-alive")]),t._v("缓存等）")])]),t._v(" "),a("p",[a("mark",[t._v("让文件渲染更快")])]),t._v(" "),a("ul",[a("li",[t._v("提前渲染："),a("code",[t._v("ssr")]),t._v("服务器端渲染")]),t._v(" "),a("li",[t._v("避免渲染阻塞："),a("code",[t._v("CSS")]),t._v("放在"),a("code",[t._v("HTML")]),t._v("的"),a("code",[t._v("head")]),t._v("中 "),a("code",[t._v("JS")]),t._v("放在"),a("code",[t._v("HTML")]),t._v("的"),a("code",[t._v("body")]),t._v("底部")]),t._v(" "),a("li",[t._v("避免无用渲染：懒加载")]),t._v(" "),a("li",[t._v("减少渲染次数：对"),a("code",[t._v("dom")]),t._v("查询进行缓存、将"),a("code",[t._v("dom")]),t._v("操作合并、使用减少重排的标签")])]),t._v(" "),a("p",[a("strong",[t._v("或者可以这样")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/duochizhacai/generatePic/img/202201271550063.png",alt:""}}),a("strong",[t._v("其实可以参照那道输入"),a("code",[t._v("url")]),t._v("到显示全过程的问题")])]),t._v(" "),a("ol",[a("li",[a("code",[t._v("DNS")]),t._v("的预解析("),a("code",[t._v("dns-prefetch")]),t._v(")(尽量放在网页的前面)")]),t._v(" "),a("li",[t._v("缓存可以避免重复加载资源 "),a("code",[t._v("etc")]),t._v("不变的资源用强缓存("),a("code",[t._v("expires")]),t._v(", "),a("code",[t._v("cache-control:max-age")]),t._v(")... 顺序"),a("code",[t._v("cc>expire")]),t._v(" "),a("ul",[a("li",[t._v("后面唠唠协商缓存"),a("code",[t._v("Last-Modified IF-Modified-Since")]),t._v(" "),a("code",[t._v("Etag IF-None-Match")])])])])]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("这里要注意一下")]),t._v(" "),a("p",[t._v("大多数候选人都只答概念，我们可以从什么文件出发谈一下选型")]),t._v(" "),a("ul",[a("li",[t._v("对于某些不需要缓存的资源，可以使用 "),a("code",[t._v("Cache-control: no-store")]),t._v(" ，表示该资源不需要缓存")]),t._v(" "),a("li",[t._v("对于频繁变动的资源，可以使用 "),a("code",[t._v("Cache-Control: no-cache")]),t._v(" 并配合 "),a("code",[t._v("ETag")]),t._v(" 使用，表示该资源已被缓存，但是每次都会发送请求询问资源是否更新。")]),t._v(" "),a("li",[t._v("对于代码文件来说，通常使用 "),a("code",[t._v("Cache-Control: max-age=31536000")]),t._v(" 并配合策略缓存使用，然后对文件进行指纹处理，一旦文件名变动就会立刻下载新的文件")])])]),t._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[a("p",[t._v("讲完缓存可以"),a("code",[t._v("HTTP2")]),t._v("的多路复用，让多个请求复用同一个"),a("code",[t._v("TCP")]),t._v("连接，还有"),a("code",[t._v("2.0")]),t._v("的头信息压缩")])]),t._v(" "),a("li",[a("p",[t._v("预加载："),a("code",[t._v("preload")]),t._v(" 可以对当前页面所需的脚本、样式等资源进行预加载")])]),t._v(" "),a("li",[a("p",[t._v("预加载：有些资源不需要马上用到，但是希望尽早获取,降低首屏加载时间")]),t._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 强制浏览器请求资源，并且不会阻塞 onload 事件 --\x3e")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("rel")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("preload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://example.com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("这里可以顺便提一嘴")]),t._v(" "),a("p",[t._v("可以在当前页加载下一页的资源，提升速度")])])]),t._v(" "),a("li",[a("p",[t._v("预渲染：将下载的文件预先在后台渲染，可以使用以下代码开启预渲染")]),t._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 虽然可以提高页面的加载速度，但是要确保该页面百分百会被用户在之后打开，否则就白白浪费资源去渲染 --\x3e")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("rel")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("prerender"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://crucials.com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("图片懒加载(监听"),a("code",[t._v("scroll")]),t._v("、图片"),a("code",[t._v("data-src")]),t._v(")")])]),t._v(" "),a("li",[a("p",[t._v("图片加载")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("cdn")]),t._v("加载")]),t._v(" "),a("li",[t._v("小图用"),a("code",[t._v("base64")])]),t._v(" "),a("li",[t._v("多图标用雪碧图")]),t._v(" "),a("li",[t._v("支持"),a("code",[t._v("webp")]),t._v("的浏览器用"),a("code",[t._v("webp")])]),t._v(" "),a("li",[t._v("用"),a("code",[t._v("svg")]),t._v("代替"),a("code",[t._v("png")])]),t._v(" "),a("li",[t._v("照片用"),a("code",[t._v("jpeg")])])])]),t._v(" "),a("li",[a("p",[t._v("其他文件优化")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("css")]),t._v("放"),a("code",[t._v("head")])]),t._v(" "),a("li",[t._v("服务端开启"),a("code",[t._v("gzip")])]),t._v(" "),a("li",[a("code",[t._v("script")]),t._v("的"),a("code",[t._v("defer")]),t._v("和"),a("code",[t._v("async")])]),t._v(" "),a("li",[t._v("使用"),a("code",[t._v("webworker")]),t._v("另开线程执行脚本不阻塞渲染")]),t._v(" "),a("li",[t._v("静态资源用"),a("code",[t._v("cdn")]),t._v("加载，避免"),a("code",[t._v("cdn")]),t._v("的域名和主站相同致携带"),a("code",[t._v("cookies")])])])]),t._v(" "),a("li",[a("p",[t._v("运行时优化")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("content")]),t._v("方面:减少"),a("code",[t._v("http")]),t._v("请求，"),a("code",[t._v("css")]),t._v("精灵图减少"),a("code",[t._v("dns")]),t._v("查询")]),t._v(" "),a("li",[a("code",[t._v("css")]),t._v("选择器...(尽量不嵌套.. "),a("code",[t._v("css3")]),t._v("开启"),a("code",[t._v("GPU")]),t._v(",使用"),a("code",[t._v("link")]),t._v("代替"),a("code",[t._v("@import")]),t._v(")")]),t._v(" "),a("li",[t._v("重排重绘...")]),t._v(" "),a("li",[t._v("动画优化(使用"),a("code",[t._v("requestAnimationFrame")]),t._v("代替"),a("code",[t._v("setTimeout")]),t._v(")")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("webpack")]),t._v("优化")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("webpack4+")]),t._v(" 打包自动开启代码压缩")]),t._v(" "),a("li",[t._v("使用"),a("code",[t._v("es6")]),t._v("模块开启"),a("code",[t._v("tree shaking")])]),t._v(" "),a("li",[t._v("路由拆分代码，按需加载")]),t._v(" "),a("li",[t._v("打包的文件添加"),a("code",[t._v("hash")]),t._v("配合"),a("code",[t._v("ETag")])])])]),t._v(" "),a("li",[a("p",[t._v("监控("),a("mark",[t._v("待完善")]),t._v(")")]),t._v(" "),a("blockquote",[a("p",[t._v("对于代码运行错误，通常的办法是使用 "),a("code",[t._v("window.onerror")]),t._v(" 拦截报错。该方法能拦截到大部分的详细报错信息，但是也有例外")])]),t._v(" "),a("ul",[a("li",[t._v("对于跨域的代码运行错误会显示 "),a("code",[t._v("Script error")]),t._v(". 对于这种情况我们需要给 "),a("code",[t._v("script")]),t._v(" 标签添加 "),a("code",[t._v("crossorigin")]),t._v(" 属性")]),t._v(" "),a("li",[t._v("对于某些浏览器可能不会显示调用栈信息，这种情况可以通过 "),a("code",[t._v("arguments.callee.caller")]),t._v(" 来做栈递归")]),t._v(" "),a("li",[t._v("对于异步代码来说，可以使用 "),a("code",[t._v("catch")]),t._v(" 的方式捕获错误。比如 "),a("code",[t._v("Promise")]),t._v(" 可以直接使用 "),a("code",[t._v("catch")]),t._v(" 函数，"),a("code",[t._v("async await")]),t._v(" 可以使用 "),a("code",[t._v("try catch")])]),t._v(" "),a("li",[t._v("但是要注意线上运行的代码都是压缩过的，需要在打包时生成 "),a("code",[t._v("sourceMap")]),t._v(" 文件便于 "),a("code",[t._v("debug")]),t._v("。")]),t._v(" "),a("li",[t._v("对于捕获的错误需要上传给服务器，通常可以通过 "),a("code",[t._v("img")]),t._v(" 标签的 "),a("code",[t._v("src")]),t._v("发起一个请求⬇️")])])])])])}),[],!1,null,null,null);s.default=e.exports}}]);