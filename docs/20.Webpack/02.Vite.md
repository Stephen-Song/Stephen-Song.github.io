---
title: Vite
date: 2022-02-12 16:27:49
permalink: /pages/c10c70/
---

# `Vite`

## 说一下`Vite`的原理

利用浏览器去解析模块，在服务器端按需编译返回，完全跳过了打包这个概念，服务器随起随用。

- 浏览器遇到 `es import` 会发起请求
- `vite` 拦截请求(实际上起了一个服务)，并返回转换编译后的代码
- `vite` 区分不同类型的文件请求，并将这些请求交给专门的函数去处理
- 浏览器遇到 返回的代码还有请求的，继续发起请求
- 实现按需加载，不用打包，启动时间和更新大大缩短
- 文件变化了，直接让浏览器再次发起请求即可

![](https://cdn.jsdelivr.net/gh/duochizhacai/generatePic/img/202202121701195.png)

**细节**

**改写路径**

`vite`会将文件下引用`node_modules`的路径`import { createApp } from 'vue'` 换成了 `import { createApp } from '/@modules/vue`。作用应该是将node_modules对应的模块缓存在浏览器中

**对`vue`文件拆解请求**

把原本一个 `.vue` 的文件拆成了三个请求（分别对应 `script`、`style` 和`template`） ，浏览器会先收到包含 `script` 逻辑的 `App.vue` 的响应，然后解析到 `template` 和 `style` 的路径后，会再次发起 HTTP 请求来请求对应的资源，此时 `Vite` 对其拦截并再次处理后返回相应的内容



**缺点**

1. 只有在进行某个页面中才会知道文件的编译错误
2. 初始化页面假如依赖的模块变多也会变慢

