---
title: è®¾è®¡æ¨¡å¼
date: 2022-01-10 22:46:51
permalink: /pages/e3cba5/
---

# è®¾è®¡æ¨¡å¼

## å•ä¾‹æ¨¡å¼<badge text="é‡è¦" />

:::tip æ¦‚å¿µ

é¡¾åæ€ä¹‰ï¼Œå•ä¾‹æ¨¡å¼ä¸­`Class`çš„å®ä¾‹ä¸ªæ•°æœ€å¤šä¸º`1`ã€‚å½“éœ€è¦ä¸€ä¸ªå¯¹è±¡å»è´¯ç©¿æ•´ä¸ªç³»ç»Ÿæ‰§è¡ŒæŸäº›ä»»åŠ¡æ—¶ï¼Œå•ä¾‹æ¨¡å¼å°±æ´¾ä¸Šäº†ç”¨åœºã€‚è€Œé™¤æ­¤ä¹‹å¤–çš„åœºæ™¯å°½é‡é¿å…å•ä¾‹æ¨¡å¼çš„ä½¿ç”¨ï¼Œå› ä¸ºå•ä¾‹æ¨¡å¼ä¼šå¼•å…¥å…¨å±€çŠ¶æ€ï¼Œè€Œä¸€ä¸ªå¥åº·çš„ç³»ç»Ÿåº”è¯¥é¿å…å¼•å…¥è¿‡å¤šçš„å…¨å±€çŠ¶æ€

:::

**å®ç°å•ä¾‹æ¨¡å¼éœ€è¦è§£å†³ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š**

- å¦‚ä½•ç¡®å®š`Class`åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Ÿ
- å¦‚ä½•ç®€ä¾¿çš„è®¿é—®`Class`çš„å”¯ä¸€å®ä¾‹ï¼Ÿ
- `Class`å¦‚ä½•æ§åˆ¶å®ä¾‹åŒ–çš„è¿‡ç¨‹ï¼Ÿ
- å¦‚ä½•å°†`Class`çš„å®ä¾‹ä¸ªæ•°é™åˆ¶ä¸º`1`ï¼Ÿ

> æˆ‘ä»¬ä¸€èˆ¬é€šè¿‡å®ç°ä»¥ä¸‹ä¸¤ç‚¹æ¥è§£å†³ä¸Šè¿°é—®é¢˜ï¼š

- éšè—`Class`çš„æ„é€ å‡½æ•°ï¼Œé¿å…å¤šæ¬¡å®ä¾‹åŒ–
- é€šè¿‡æš´éœ²ä¸€ä¸ª `getInstance()` æ–¹æ³•æ¥åˆ›å»º/è·å–å”¯ä¸€å®ä¾‹

```js
class Singleton {
  constructor(name) {
    this.name = name;
    this.instance = null;
  }

  getName() {
    console.log(this.name);
  }

  getInstance(name) {
    if (!this.instance) {
      this.instance = new Singleton(name);
    }

    return this.instance;
  }
}

const singleton = new Singleton();

const a = singleton.getInstance("a");
const b = singleton.getInstance("b");

console.log(a);
console.log(b);
console.log(a === b);
```

**å®ç°çš„å…³é”®ç‚¹æœ‰ï¼š**

- `getInstance()` ä¸ºä¸€ä¸ª é—­åŒ… ï¼Œä½¿ç”¨é—­åŒ…ä¿å­˜å±€éƒ¨ä½œç”¨åŸŸä¸­çš„å•ä¾‹å¯¹è±¡å¹¶è¿”å›ã€‚



**åœºæ™¯ä¾‹å­**

- å®šä¹‰å‘½åç©ºé—´å’Œå®ç°åˆ†æ”¯å‹æ–¹æ³•
- ç™»å½•æ¡†
- `vuex` å’Œ `redux`ä¸­çš„`store`
- é€‚ç”¨äºå¼¹æ¡†çš„å®ç°, å…¨å±€ç¼“å­˜ï¼Œä¸€ä¸ªå•ä¸€å¯¹è±¡ã€‚æ¯”å¦‚ï¼šå¼¹çª—ï¼Œæ— è®ºç‚¹å‡»å¤šå°‘æ¬¡ï¼Œå¼¹çª—åªåº”è¯¥è¢«åˆ›å»ºä¸€æ¬¡

**ä¼˜ç‚¹**

- åˆ’åˆ†å‘½åç©ºé—´ï¼Œå‡å°‘å…¨å±€å˜é‡
- å¢å¼ºæ¨¡å—æ€§ï¼ŒæŠŠè‡ªå·±çš„ä»£ç ç»„ç»‡åœ¨ä¸€ä¸ªå…¨å±€å˜é‡åä¸‹ï¼Œæ”¾åœ¨å•ä¸€ä½ç½®ï¼Œä¾¿äºç»´æŠ¤
- ä¸”åªä¼šå®ä¾‹åŒ–ä¸€æ¬¡ã€‚ç®€åŒ–äº†ä»£ç çš„è°ƒè¯•å’Œç»´æŠ¤

**ç¼ºç‚¹**

- ç”±äºå•ä¾‹æ¨¡å¼æä¾›çš„æ˜¯ä¸€ç§å•ç‚¹è®¿é—®ï¼Œæ‰€ä»¥å®ƒæœ‰å¯èƒ½å¯¼è‡´æ¨¡å—é—´çš„å¼ºè€¦åˆ
- ä»è€Œä¸åˆ©äºå•å…ƒæµ‹è¯•ã€‚æ— æ³•å•ç‹¬æµ‹è¯•ä¸€ä¸ªè°ƒç”¨äº†æ¥è‡ªå•ä¾‹çš„æ–¹æ³•çš„ç±»ï¼Œè€Œåªèƒ½æŠŠå®ƒä¸é‚£ä¸ªå•ä¾‹ä½œä¸ºä¸€ ä¸ªå•å…ƒä¸€èµ·æµ‹è¯•ã€‚

## å¤–è§‚æ¨¡å¼

:::tip æ¦‚å¿µ

å¤–è§‚æ¨¡å¼æ˜¯æœ€å¸¸è§çš„è®¾è®¡æ¨¡å¼ä¹‹ä¸€ï¼Œå®ƒä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªç»Ÿä¸€çš„é«˜å±‚æ¥å£ï¼Œä½¿å­ç³»ç»Ÿæ›´å®¹æ˜“ä½¿ç”¨ã€‚ç®€è€Œè¨€ä¹‹å¤–è§‚è®¾è®¡æ¨¡å¼å°±æ˜¯æŠŠå¤šä¸ªå­ç³»ç»Ÿä¸­å¤æ‚é€»è¾‘è¿›è¡ŒæŠ½è±¡ï¼Œä»è€Œæä¾›ä¸€ä¸ªæ›´ç»Ÿä¸€ã€æ›´ç®€æ´ã€æ›´æ˜“ç”¨çš„APIã€‚æ¯”å¦‚`JQuery`å°±æŠŠå¤æ‚çš„åŸç”Ÿ`DOM`æ“ä½œè¿›è¡Œäº†æŠ½è±¡å’Œå°è£…ï¼Œå¹¶æ¶ˆé™¤äº†æµè§ˆå™¨ä¹‹é—´çš„å…¼å®¹é—®é¢˜ï¼Œä»è€Œæä¾›äº†ä¸€ä¸ªæ›´é«˜çº§æ›´æ˜“ç”¨çš„ç‰ˆæœ¬ã€‚

:::

```js
let addMyEvent = function (el, ev, fn) {
    if (el.addEventListener) {
        el.addEventListener(ev, fn, false)
    } else if (el.attachEvent) {
        el.attachEvent('on' + ev, fn)
    } else {
        el['on' + ev] = fn
    }
};
```

**å°è£…æ¥å£**

```js
let myEvent = {
    // ...
    stop: e => {
        e.stopPropagation();
        e.preventDefault();
    }
};
```

**åœºæ™¯**

- è®¾è®¡åˆæœŸï¼Œåº”è¯¥è¦æœ‰æ„è¯†åœ°å°†ä¸åŒçš„ä¸¤ä¸ªå±‚åˆ†ç¦»ï¼Œæ¯”å¦‚ç»å…¸çš„ä¸‰å±‚ç»“æ„ï¼Œåœ¨æ•°æ®è®¿é—®å±‚å’Œä¸šåŠ¡é€»è¾‘å±‚ã€ä¸šåŠ¡é€»è¾‘å±‚å’Œè¡¨ç¤ºå±‚ä¹‹é—´å»ºç«‹å¤–è§‚`Facade`
- åœ¨å¼€å‘é˜¶æ®µï¼Œå­ç³»ç»Ÿå¾€å¾€å› ä¸ºä¸æ–­çš„é‡æ„æ¼”åŒ–è€Œå˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œå¢åŠ å¤–è§‚`Facade`å¯ä»¥æä¾›ä¸€ä¸ªç®€å•çš„æ¥å£ï¼Œå‡å°‘ä»–ä»¬ä¹‹é—´çš„ä¾èµ–ã€‚
- åœ¨ç»´æŠ¤ä¸€ä¸ªé—ç•™çš„å¤§å‹ç³»ç»Ÿæ—¶ï¼Œå¯èƒ½è¿™ä¸ªç³»ç»Ÿå·²ç»å¾ˆéš¾ç»´æŠ¤äº†ï¼Œè¿™æ—¶å€™ä½¿ç”¨å¤–è§‚`Facade`ä¹Ÿæ˜¯éå¸¸åˆé€‚çš„ï¼Œä¸ºç³»ç³»ç»Ÿå¼€å‘ä¸€ä¸ªå¤–è§‚`Facade`ç±»ï¼Œä¸ºè®¾è®¡ç²—ç³™å’Œé«˜åº¦å¤æ‚çš„é—ç•™ä»£ç æä¾›æ¯”è¾ƒæ¸…æ™°çš„æ¥å£ï¼Œè®©æ–°ç³»ç»Ÿå’Œ`Facade`å¯¹è±¡äº¤äº’ï¼Œ`Facade`ä¸é—ç•™ä»£ç äº¤äº’æ‰€æœ‰çš„å¤æ‚å·¥ä½œã€‚

**ä¼˜ç‚¹**

- å‡å°‘ç³»ç»Ÿç›¸äº’ä¾èµ–
- æé«˜çµæ´»æ€§
- æé«˜äº†å®‰å…¨æ€§

**ç¼ºç‚¹**

> ä¸ç¬¦åˆå¼€é—­åŸåˆ™ï¼Œå¦‚æœè¦æ”¹ä¸œè¥¿å¾ˆéº»çƒ¦ï¼Œç»§æ‰¿é‡å†™éƒ½ä¸åˆé€‚ã€‚

## ä»£ç†æ¨¡å¼<badge text="é‡è¦" />

:::tip æ¦‚å¿µ

ä¸ºæŸä¸ªå¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ï¼ˆè‡ªå®šä¹‰æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªå¯¹è±¡çš„èµ„æºï¼‰

:::

ä¸¾ä¸ª ğŸŒ°ï¼šåŒåä¸€ï¼Œå°ç¾æœ‰äº¿ä»¶å¿«é€’åˆ°äº†ï¼Œæœ‰äº›åŒ…è£¹å¤ªé‡äº†è‡ªå·±æ‹¿ä¸åŠ¨ã€‚äºæ˜¯ï¼Œå¥¹æ‹œæ‰˜å·¥å…·äººå°æ˜å¸®å¿™ï¼Œå°æ˜æ¬£ç„¶å‰å¾€å¿«é€’ç‚¹å–ä»¶ã€‚è¿™é‡Œï¼Œå°æ˜å¸®å°ç¾å–å¿«é€’å°±èµ·åˆ°äº†ä»£ç†çš„ä½œç”¨ã€‚æ³¨æ„ï¼šæ•´ä¸ªåŠ¨ä½œè¿˜æ˜¯å°ç¾å‘èµ·çš„ï¼Œå°æ˜å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªé€æ˜çš„ä¸­é—´äººï¼Œç›´æ¥çœ‹ä»£ç ã€‚

```js
let expressPoint = {
    pickUp() {
        console.log('å–å¿«é€’æˆåŠŸ...')
    }
}
let Ming = {
    getMsg(target) {
        target.pickUp()
    }
}
let Mei = {
    getExpress(target) {
        Ming.getMsg(target) // å°æ˜å–ä»¶ï¼Œå¯ä»¥é…åˆå®šæ—¶å™¨ç­‰é€»è¾‘åšåˆ°å»¶è¿Ÿå–ä»¶
    }
}
Mei.getExpress(expressPoint) // å°ç¾å–ä»¶ï¼Œè™½ç„¶æ˜¯é€šè¿‡å°æ˜ä»£ç†çš„ã€‚

// å–å¿«é€’æˆåŠŸ...
```

**åœºæ™¯**

`HTML`å…ƒ ç´ äº‹ä»¶ä»£ç†

```html
<ul id="ul">
  <li>1</li>
  <li>2</li>
  <li>3</li>
</ul>
<script>
  let ul = document.querySelector('#ul');
  ul.addEventListener('click', event => {
    console.log(event.target);
  });
</script>
```

**ä¼˜ç‚¹**

- ä»£ç†æ¨¡å¼èƒ½å°†ä»£ç†å¯¹è±¡ä¸è¢«è°ƒç”¨å¯¹è±¡åˆ†ç¦»ï¼Œé™ä½äº†ç³»ç»Ÿçš„è€¦åˆåº¦ã€‚ä»£ç†æ¨¡å¼åœ¨å®¢æˆ·ç«¯å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸€ä¸ªä¸­ä»‹ä½œç”¨ï¼Œè¿™æ ·å¯ä»¥èµ·åˆ°ä¿æŠ¤ç›®æ ‡å¯¹è±¡çš„ä½œç”¨
- ä»£ç†å¯¹è±¡å¯ä»¥æ‰©å±•ç›®æ ‡å¯¹è±¡çš„åŠŸèƒ½ï¼›é€šè¿‡ä¿®æ”¹ä»£ç†å¯¹è±¡å°±å¯ä»¥äº†ï¼Œç¬¦åˆå¼€é—­åŸåˆ™ï¼›

**ç¼ºç‚¹**

å¤„ç†è¯·æ±‚é€Ÿåº¦å¯èƒ½æœ‰å·®åˆ«ï¼Œéç›´æ¥è®¿é—®å­˜åœ¨å¼€é”€

## å·¥å‚æ¨¡å¼<badge text="é‡è¦" />

:::tip æ¦‚å¿µ

å·¥å‚æ¨¡å¼å®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè¿™ä¸ªæ¥å£ç”±å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸€ä¸ªç±»ã€‚è¯¥æ¨¡å¼ä½¿ä¸€ä¸ªç±»çš„å®ä¾‹åŒ–å»¶è¿Ÿåˆ°äº†å­ç±»ã€‚è€Œå­ç±»å¯ä»¥é‡å†™æ¥å£æ–¹æ³•ä»¥ä¾¿åˆ›å»ºçš„æ—¶å€™æŒ‡å®šè‡ªå·±çš„å¯¹è±¡ç±»å‹ã€‚

:::

```js
class Product {
    constructor(name) {
        this.name = name
    }
    init() {
        console.log('init')
    }
    fun() {
        console.log('fun')
    }
}

class Factory {
    create(name) {
        return new Product(name)
    }
}

// use
let factory = new Factory()
let p = factory.create('p1')
p.init()
p.fun()
```

**åœºæ™¯**

- å¦‚æœä½ ä¸æƒ³è®©æŸä¸ªå­ç³»ç»Ÿä¸è¾ƒå¤§çš„é‚£ä¸ªå¯¹è±¡ä¹‹é—´å½¢æˆå¼ºè€¦åˆï¼Œè€Œæ˜¯æƒ³è¿è¡Œæ—¶ä»è®¸å¤šå­ç³»ç»Ÿä¸­è¿›è¡ŒæŒ‘é€‰çš„è¯ï¼Œé‚£ä¹ˆå·¥å‚æ¨¡å¼æ˜¯ä¸€ä¸ªç†æƒ³çš„é€‰æ‹©
- å°†`new`æ“ä½œç®€å•å°è£…ï¼Œé‡åˆ°`new`çš„æ—¶å€™å°±åº”è¯¥è€ƒè™‘æ˜¯å¦ç”¨å·¥å‚æ¨¡å¼ï¼›
- éœ€è¦ä¾èµ–å…·ä½“ç¯å¢ƒåˆ›å»ºä¸åŒå®ä¾‹ï¼Œè¿™äº›å®ä¾‹éƒ½æœ‰ç›¸åŒçš„è¡Œä¸º,è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å·¥å‚æ¨¡å¼ï¼Œç®€åŒ–å®ç°çš„è¿‡ç¨‹ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å‡å°‘æ¯ç§å¯¹è±¡æ‰€éœ€çš„ä»£ç é‡ï¼Œæœ‰åˆ©äºæ¶ˆé™¤å¯¹è±¡é—´çš„è€¦åˆï¼Œæä¾›æ›´å¤§çš„çµæ´»æ€§

**ä¼˜ç‚¹**

- åˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹å¯èƒ½å¾ˆå¤æ‚ï¼Œä½†æˆ‘ä»¬åªéœ€è¦å…³å¿ƒåˆ›å»ºç»“æœã€‚
- æ„é€ å‡½æ•°å’Œåˆ›å»ºè€…åˆ†ç¦», ç¬¦åˆâ€œå¼€é—­åŸåˆ™â€
- ä¸€ä¸ªè°ƒç”¨è€…æƒ³åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œåªè¦çŸ¥é“å…¶åç§°å°±å¯ä»¥äº†ã€‚
- æ‰©å±•æ€§é«˜ï¼Œå¦‚æœæƒ³å¢åŠ ä¸€ä¸ªäº§å“ï¼Œåªè¦æ‰©å±•ä¸€ä¸ªå·¥å‚ç±»å°±å¯ä»¥ã€‚

**ç¼ºç‚¹**

- æ·»åŠ æ–°äº§å“æ—¶ï¼Œéœ€è¦ç¼–å†™æ–°çš„å…·ä½“äº§å“ç±»,ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦
- è€ƒè™‘åˆ°ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ï¼Œéœ€è¦å¼•å…¥æŠ½è±¡å±‚ï¼Œåœ¨å®¢æˆ·ç«¯ä»£ç ä¸­å‡ä½¿ç”¨æŠ½è±¡å±‚è¿›è¡Œå®šä¹‰ï¼Œå¢åŠ äº†ç³»ç»Ÿçš„æŠ½è±¡æ€§å’Œç†è§£éš¾åº¦

**ä»€ä¹ˆæ—¶å€™ä¸ç”¨**

> å½“è¢«åº”ç”¨åˆ°é”™è¯¯çš„é—®é¢˜ç±»å‹ä¸Šæ—¶,è¿™ä¸€æ¨¡å¼ä¼šç»™åº”ç”¨ç¨‹åºå¼•å…¥å¤§é‡ä¸å¿…è¦çš„å¤æ‚æ€§.é™¤éä¸ºåˆ›å»ºå¯¹è±¡æä¾›ä¸€ä¸ªæ¥å£æ˜¯æˆ‘ä»¬ç¼–å†™çš„åº“æˆ–è€…æ¡†æ¶çš„ä¸€ä¸ªè®¾è®¡ä¸Šç›®æ ‡,å¦åˆ™æˆ‘ä¼šå»ºè®®ä½¿ç”¨æ˜ç¡®çš„æ„é€ å™¨,ä»¥é¿å…ä¸å¿…è¦çš„å¼€é”€ã€‚

ç”±äºå¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹è¢«é«˜æ•ˆçš„æŠ½è±¡åœ¨ä¸€ä¸ªæ¥å£åé¢çš„äº‹å®,è¿™ä¹Ÿä¼šç»™ä¾èµ–äºè¿™ä¸ªè¿‡ç¨‹å¯èƒ½ä¼šæœ‰å¤šå¤æ‚çš„å•å…ƒæµ‹è¯•å¸¦æ¥é—®é¢˜ã€‚

## ç­–ç•¥æ¨¡å¼<badge text="é‡è¦" />

:::tip æ¦‚å¿µ

ç­–ç•¥æ¨¡å¼ç®€å•æè¿°å°±æ˜¯ï¼šå¯¹è±¡æœ‰æŸä¸ªè¡Œä¸ºï¼Œä½†æ˜¯åœ¨ä¸åŒçš„åœºæ™¯ä¸­ï¼Œè¯¥è¡Œä¸ºæœ‰ä¸åŒçš„å®ç°ç®—æ³•ã€‚æŠŠå®ƒä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥ï¼Œå¹¶ä¸”ä½¿å®ƒä»¬å¯ä»¥äº’ç›¸æ›¿æ¢

:::

```html
<html>
<head>
    <title>ç­–ç•¥æ¨¡å¼-æ ¡éªŒè¡¨å•</title>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
</head>
<body>
    <form id = "registerForm" method="post" action="http://xxxx.com/api/register">
        ç”¨æˆ·åï¼š<input type="text" name="userName">
        å¯†ç ï¼š<input type="text" name="password">
        æ‰‹æœºå·ç ï¼š<input type="text" name="phoneNumber">
        <button type="submit">æäº¤</button>
    </form>
    <script type="text/javascript">
        // ç­–ç•¥å¯¹è±¡
        const strategies = {
          isNoEmpty: function (value, errorMsg) {
            if (value === '') {
              return errorMsg;
            }
          },
          isNoSpace: function (value, errorMsg) {
            if (value.trim() === '') {
              return errorMsg;
            }
          },
          minLength: function (value, length, errorMsg) {
            if (value.trim().length < length) {
              return errorMsg;
            }
          },
          maxLength: function (value, length, errorMsg) {
            if (value.length > length) {
              return errorMsg;
            }
          },
          isMobile: function (value, errorMsg) {
            if (!/^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|17[7]|18[0|1|2|3|5|6|7|8|9])\d{8}$/.test(value)) {
              return errorMsg;
            }                
          }
        }
        
        // éªŒè¯ç±»
        class Validator {
          constructor() {
            this.cache = []
          }
          add(dom, rules) {
            for(let i = 0, rule; rule = rules[i++];) {
              let strategyAry = rule.strategy.split(':')
              let errorMsg = rule.errorMsg
              this.cache.push(() => {
                let strategy = strategyAry.shift()
                strategyAry.unshift(dom.value)
                strategyAry.push(errorMsg)
                return strategies[strategy].apply(dom, strategyAry)
              })
            }
          }
          start() {
            for(let i = 0, validatorFunc; validatorFunc = this.cache[i++];) {
              let errorMsg = validatorFunc()
              if (errorMsg) {
                return errorMsg
              }
            }
          }
        }

        // è°ƒç”¨ä»£ç 
        let registerForm = document.getElementById('registerForm')

        let validataFunc = function() {
          let validator = new Validator()
          validator.add(registerForm.userName, [{
            strategy: 'isNoEmpty',
            errorMsg: 'ç”¨æˆ·åä¸å¯ä¸ºç©º'
          }, {
            strategy: 'isNoSpace',
            errorMsg: 'ä¸å…è®¸ä»¥ç©ºç™½å­—ç¬¦å‘½å'
          }, {
            strategy: 'minLength:2',
            errorMsg: 'ç”¨æˆ·åé•¿åº¦ä¸èƒ½å°äº2ä½'
          }])
          validator.add(registerForm.password, [ {
            strategy: 'minLength:6',
            errorMsg: 'å¯†ç é•¿åº¦ä¸èƒ½å°äº6ä½'
          }])
          validator.add(registerForm.phoneNumber, [{
            strategy: 'isMobile',
            errorMsg: 'è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·ç æ ¼å¼'
          }])
          return validator.start()
        }

        registerForm.onsubmit = function() {
          let errorMsg = validataFunc()
          if (errorMsg) {
            alert(errorMsg)
            return false
          }
        }
    </script>
</body>
</html>
```

**åœºæ™¯ä¾‹å­**

- å¦‚æœåœ¨ä¸€ä¸ªç³»ç»Ÿé‡Œé¢æœ‰è®¸å¤šç±»ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ä»…åœ¨äºå®ƒä»¬çš„'è¡Œä¸º'ï¼Œé‚£ä¹ˆä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥åŠ¨æ€åœ°è®©ä¸€ä¸ªå¯¹è±¡åœ¨è®¸å¤šè¡Œä¸ºä¸­é€‰æ‹©ä¸€ç§è¡Œä¸ºã€‚
- ä¸€ä¸ªç³»ç»Ÿéœ€è¦åŠ¨æ€åœ°åœ¨å‡ ç§ç®—æ³•ä¸­é€‰æ‹©ä¸€ç§ã€‚
- è¡¨å•éªŒè¯

**ä¼˜ç‚¹**

- åˆ©ç”¨ç»„åˆã€å§”æ‰˜ã€å¤šæ€ç­‰æŠ€æœ¯å’Œæ€æƒ³ï¼Œå¯ä»¥æœ‰æ•ˆçš„é¿å…å¤šé‡æ¡ä»¶é€‰æ‹©è¯­å¥
- æä¾›äº†å¯¹å¼€æ”¾-å°é—­åŸåˆ™çš„å®Œç¾æ”¯æŒï¼Œå°†ç®—æ³•å°è£…åœ¨ç‹¬ç«‹çš„`strategy`ä¸­ï¼Œä½¿å¾—å®ƒä»¬æ˜“äºåˆ‡æ¢ï¼Œç†è§£ï¼Œæ˜“äºæ‰©å±•
- åˆ©ç”¨ç»„åˆå’Œå§”æ‰˜æ¥è®©`Context`æ‹¥æœ‰æ‰§è¡Œç®—æ³•çš„èƒ½åŠ›ï¼Œè¿™ä¹Ÿæ˜¯ç»§æ‰¿çš„ä¸€ç§æ›´è½»ä¾¿çš„ä»£æ›¿æ–¹æ¡ˆ

**ç¼ºç‚¹**

- ä¼šåœ¨ç¨‹åºä¸­å¢åŠ è®¸å¤šç­–ç•¥ç±»æˆ–è€…ç­–ç•¥å¯¹è±¡
- è¦ä½¿ç”¨ç­–ç•¥æ¨¡å¼ï¼Œå¿…é¡»äº†è§£æ‰€æœ‰çš„`strategy`ï¼Œå¿…é¡»äº†è§£å„ä¸ª`strategy`ä¹‹é—´çš„ä¸åŒç‚¹ï¼Œè¿™æ ·æ‰èƒ½é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„`strategy`

## è§‚å¯Ÿè€…æ¨¡å¼<badge text="é‡è¦" />

:::tip æ¦‚å¿µ

æ—¥å¸¸ç”Ÿæ´»ä¸­çš„åº”ç”¨ä¹Ÿæ¯”æ¯”çš†æ˜¯ï¼Œæ¯”å¦‚ä½ è®¢é˜…äº†æŸä¸ªåšä¸»çš„é¢‘é“ï¼Œå½“æœ‰å†…å®¹æ›´æ–°æ—¶ä¼šæ”¶åˆ°æ¨é€ï¼›åˆæ¯”å¦‚`JavaScript`ä¸­çš„äº‹ä»¶è®¢é˜…å“åº”æœºåˆ¶ã€‚è§‚å¯Ÿè€…æ¨¡å¼çš„æ€æƒ³ç”¨ä¸€å¥è¯æè¿°å°±æ˜¯ï¼šè¢«è§‚å¯Ÿå¯¹è±¡ï¼ˆ`subject`ï¼‰ç»´æŠ¤ä¸€ç»„è§‚å¯Ÿè€…ï¼ˆ`observer`ï¼‰ï¼Œå½“è¢«è§‚å¯Ÿå¯¹è±¡çŠ¶æ€æ”¹å˜æ—¶ï¼Œé€šè¿‡è°ƒç”¨è§‚å¯Ÿè€…çš„æŸä¸ªæ–¹æ³•å°†è¿™äº›å˜åŒ–é€šçŸ¥åˆ°è§‚å¯Ÿè€…

:::

```js
class Subject {
  constructor() {
    this.observers = []; // è§‚å¯Ÿè€…é˜Ÿåˆ—
  }
  add(observer) {
    // æ²¡æœ‰äº‹ä»¶é€šé“
    this.observers.push(observer); // å¿…é¡»å°†è‡ªå·± observer æ·»åŠ åˆ°è§‚å¯Ÿè€…é˜Ÿåˆ—
    this.observers = [...new Set(this.observers)];
  }
  notify(...args) {
    // äº²è‡ªé€šçŸ¥è§‚å¯Ÿè€…
    this.observers.forEach((observer) => observer.update(...args));
  }
  remove(observerToRemove) {
        this.observers = this.observers.filter(observer => {
      return observer !== observerToRemove;
    })
  }
}

class Observer {
  update(...args) {
    console.log(...args);
  }
}

let observer_1 = new Observer(); // åˆ›å»ºè§‚å¯Ÿè€…1
let observer_2 = new Observer();
let sub = new Subject(); // åˆ›å»ºç›®æ ‡å¯¹è±¡
sub.add(observer_1); // æ·»åŠ è§‚å¯Ÿè€…1
sub.add(observer_2);
sub.notify("I changed !");
```

**åœºæ™¯**

- `DOM`äº‹ä»¶

```js
document.body.addEventListener('click', function() {
    console.log('hello world!');
});
document.body.click()
```

- `vue` å“åº”å¼

**ä¼˜ç‚¹**

- æ”¯æŒç®€å•çš„å¹¿æ’­é€šä¿¡ï¼Œè‡ªåŠ¨é€šçŸ¥æ‰€æœ‰å·²ç»è®¢é˜…è¿‡çš„å¯¹è±¡
- ç›®æ ‡å¯¹è±¡ä¸è§‚å¯Ÿè€…ä¹‹é—´çš„æŠ½è±¡è€¦åˆå…³ç³»èƒ½å•ç‹¬æ‰©å±•ä»¥åŠé‡ç”¨
- å¢åŠ äº†çµæ´»æ€§
- è§‚å¯Ÿè€…æ¨¡å¼æ‰€åšçš„å·¥ä½œå°±æ˜¯åœ¨è§£è€¦ï¼Œè®©è€¦åˆçš„åŒæ–¹éƒ½ä¾èµ–äºæŠ½è±¡ï¼Œè€Œä¸æ˜¯ä¾èµ–äºå…·ä½“ã€‚ä»è€Œä½¿å¾—å„è‡ªçš„å˜åŒ–éƒ½ä¸ä¼šå½±å“åˆ°å¦ä¸€è¾¹çš„å˜åŒ–ã€‚

**ç¼ºç‚¹**

> è¿‡åº¦ä½¿ç”¨ä¼šå¯¼è‡´å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„è”ç³»å¼±åŒ–ï¼Œä¼šå¯¼è‡´ç¨‹åºéš¾ä»¥è·Ÿè¸ªç»´æŠ¤å’Œç†è§£



## é€‚é…å™¨æ¨¡å¼<badge text="é‡è¦" />

`é€‚é…å™¨æ¨¡å¼` çš„ä½œç”¨å°±æ˜¯è§£å†³ä¸¤ä¸ªè½¯ä»¶å®ä½“é—´æ¥å£ä¸å…¼å®¹æƒ…å†µï¼Œå®ä½“ç”µå™¨ä¾‹å¦‚ç”µæºé€‚é…å™¨ã€`USB` è½¬æ¥å£ã€å„ç§è½¬æ¢å™¨ç­‰ã€‚

éœ€æ±‚æ¥äº†ï¼Œç°åœ¨éœ€è¦ **å¯¹æ¥å¤šä¸ªå¿«é€’å¹³å° `SDK` è¿›è¡Œä¸åŒå¿«é€’å•çš„ç”Ÿæˆ** åŠŸèƒ½ã€‚

```js
// é¡ºä¸°
const sfOrderService = {
    create() {
    	console.log('é¡ºä¸°è®¢å•å·²ç”Ÿæˆ...')
    }
}
// éŸµè¾¾
const ydOrderService = {
    create() {
    	console.log('éŸµè¾¾è®¢å•å·²ç”Ÿæˆ...')
    }
}
// createOrder æä¾›ç»™ä½¿ç”¨è€…è°ƒç”¨
const createOrder = (express) => {
    if (express.create instanceof Function) express.create()
}
createOrder(sfOrderService)
createOrder(ydOrderService)

// é¡ºä¸°è®¢å•å·²ç”Ÿæˆ...
// éŸµè¾¾è®¢å•å·²ç”Ÿæˆ...
```

ç°åœ¨æ–°çš„éœ€æ±‚æ¥äº†ï¼Œæˆ‘ä»¬éœ€è¦é›†æˆåœ†é€š `SDK`ï¼Œä½†æ˜¯åœ†é€š `SDK` çš„æ–¹æ³•æ˜¯ `generate`ï¼Œä¸æ˜¯ `create`ã€‚ä¸ºäº†æ»¡è¶³å¼€é—­åŸåˆ™ï¼Œæˆ‘ä»¬æƒ³åˆ°äº†é€‚é…å™¨æ¨¡å¼ã€‚

```js
// åœ†é€š
const ytOrderService = {
    generate() {
    	console.log('åœ†é€šè®¢å•å·²ç”Ÿæˆ...')
    }
}
// é€‚é…å™¨
const ytExpressAdapater = {
    create() {
    	return ytOrderService.generate()
    }
}
// ç°åœ¨å¯ä»¥ä½¿ç”¨ createOrder ç”Ÿæˆè®¢å•äº†ï¼Œå“ˆå“ˆ
createOrder(ytExpressAdapater)

// åœ†é€šè®¢å•å·²ç”Ÿæˆ...
```

å¦å¤–ä¸€ä¸ªå¸¸è§çš„å¼€å‘åœºæ™¯ï¼š`æ•°æ®æ ¼å¼å˜æ›´`

```js
// è¿™æ˜¯æˆ‘ä»¬ä¹‹å‰ä¸Šä¼ èµ„æºï¼Œåå°ç»™æˆ‘ä»¬è¿”å›çš„æ–‡ä»¶ä¿¡æ¯
const responseUploadFile = {
    startTime: '',
    file: {
    	size: '100kb',
        type: 'text',
        ...
    },
    id: ''
}
// æŸå¤©åå°å°†è¿”å›æ ¼å¼å˜åŠ¨äº†ï¼Œå˜ä¸ºï¼š
const changeResUploadFile = {
    size: '100kb',
    type: 'text',
    startTime: '',
    id: '',
    ...
}
// ä¸ºäº†ä¸å½±å“æ—§æœ‰ä¸šåŠ¡ï¼Œå¯¼è‡´ BUG å’Œå›å½’æµ‹è¯•ï¼Œå†™ä¸ªé€‚é…å™¨ç”¨æ¥æ•°æ®è½¬æ¢å§...
const responseUploadFileAdapter = (uploadFile) = > {
    const { startTime = '', size = '', type = '', id = '', ... } = uploadFile
    return {
    	startTime,
        file: {
            size,
            type,
            ...
        },
        id
    }
}
responseUploadFileAdapter(changeResUploadFile) // è½¬æ¢æˆæ—§æ ¼å¼äº†
```

ç”±æ­¤çœ‹å‡ºå‰åç«¯åˆ†ç¦»å¼€å‘ï¼Œæ•°æ®æ“ä½œçš„ `è‡ªç”±åº¦` æ˜¯å¾ˆé«˜çš„ã€‚

## å‘å¸ƒè®¢é˜…æ¨¡å¼<badge text="é‡è¦" />

å‰é¢å·²ç»æ¢³ç†è¿‡åŒºåˆ«äº†ï¼Œç›´æ¥å¼€å§‹å®ç°ï¼š

```js
class PublicSubject { // åªæœ‰ä¸€ä¸ªè°ƒåº¦ä¸­å¿ƒ
    constructor() {
        this.subscribers = {}
    }
    subscribe(type, callback) { // è®¢é˜…
        let res = this.subscribers[type]
        if (!res) {
            this.subscribers[type] = [callback]
        } else {
            res.push(callback)
        }
    }
    publish(type, ...args) { // å‘å¸ƒ
        let res = this.subscribers[type] || []
        res.forEach(callback => callback(...args))
    }
}

let pubSub = new PublicSubject()
pubSub.subscribe('blog', (arg) => console.log(`${arg} æ›´æ–°äº†`)) // A è®¢é˜… Keith
pubSub.subscribe('blog', (arg) => console.log(`${arg} æ›´æ–°äº†`)) // B è®¢é˜… Keith
pubSub.publish('blog', 'æ˜é‡‘ Keith')

// æ˜é‡‘ Keith æ›´æ–°äº†
// æ˜é‡‘ Keith æ›´æ–°äº†
å¤åˆ¶ä»£ç 
```

å½“ç„¶ï¼Œè¿™ä¸ªç‰ˆæœ¬åŠŸèƒ½è¿˜ä¸å¤Ÿå®Œå–„ï¼Œå®é™…ä¸Šï¼Œ`å‘å¸ƒ-è®¢é˜…æ¨¡å¼` é€šå¸¸è¢«ç”¨åœ¨äº‹ä»¶ç›‘å¬å’Œè§¦å‘åŠŸèƒ½ä¸Šï¼Œæˆ‘ä»¬å¯èƒ½è¿˜éœ€æ±‚ç§»é™¤è®¢é˜…ã€‚æ¯”å¦‚å¸¸è§çš„ `Vue` çˆ¶å­ç»„ä»¶é€šä¿¡ `$emitã€$onã€$offã€$once`ï¼Œ`Vue` çš„å“åº”å¼ï¼Œåæ–‡è¦ä»‹ç»çš„ `redux`ï¼Œä»¥åŠ `nodejs Event` æ¨¡å— çš„ `eventEmitter` ç±»å®ç°ç­‰å‡æœ‰åº”ç”¨ã€‚

é‚£ä¹ˆï¼Œæˆ‘ä»¬æ¥å®ç°ä¸‹ï¼š

```js
// once å‚æ•°è¡¨ç¤ºæ˜¯å¦åªæ˜¯è§¦å‘ä¸€æ¬¡
const wrapCallback = (fn, once=false) => ({ callback: fn, once })
class EventEmitter {
    constructor() {
        this.events = new Map()
    }
    on(type, fn, once=false) { // ç›‘å¬è®¢é˜…
        let handler = this.events.get(type)
        if (!handler) {
            this.events.set(type, wrapCallback(fn, once)) // ç»‘å®šå›è°ƒ
        } else if (handler && typeof handler.callback === 'function') {
            this.events.set(type, [handler, wrapCallback(fn, once)]) // è¶…è¿‡ä¸€ä¸ªè½¬ä¸ºæ•°ç»„
        } else {
            handler.push(wrapCallback(fn, once))
        }
    }
    off(type, fn) { // åˆ é™¤æŸä¸ªäº‹ä»¶çš„å›è°ƒï¼Œå‡å¦‚å›è°ƒ <= 1ï¼Œåˆ™ç­‰åŒ allOff æ–¹æ³•
        let handler = this.events.get(type)
        if (!handler) return;
        // åªæœ‰ä¸€ä¸ªå›è°ƒäº‹ä»¶ç›´æ¥åˆ é™¤è¯¥è®¢é˜…
        if (!Array.isArray(handler) && 
        handler.callback === fn.callback) this.events.delete(type)
        for (let i=0; i<handler.length; i++) {
            let item = handler[i]
            if (item.callback === fn.callback) {
                handler.splice(i, 1)
                i-- // æ•°ç»„å¡Œé™·ï¼Œi å¾€å‰ä¸€ä½
                if (handler.length === 1) this.events.set(type, handler[0])
            }
        }
    }
    // onceï¼šè¯¥è®¢é˜…äº‹ä»¶ type åªè§¦å‘ä¸€æ¬¡ï¼Œä¹‹åè‡ªåŠ¨ç§»é™¤
    once(type, fn) {
        this.on(type, fn, true)
    }
    emit(type, ...args) {
        let handler = this.events.get(type)
        if (!handler) return;
        if (Array.isArray(handler)) {
            handler.map(item => {
                item.callback.apply(this, args) // args å‚æ•°å°‘ï¼Œå¯ä»¥æ¢æˆ call
                if (item.once) this.off(type, item) // å¤„ç† once çš„æƒ…å†µï¼Œoff ç§»é™¤
            })
        } else {
            handler.callback.apply(this, args) // å¤„ç†éæ•°ç»„
        }
    }
    allOff(type) {
        let handler = this.events.get(type)
        if (!handler) return;
        this.events.delete(type)
    }
}

let e = new EventEmitter()
e.on('eventA', () => {
  console.log('eventA äº‹ä»¶è§¦å‘')
})
e.on('eventA', () => {
  console.log('âœ¨ eventA äº‹ä»¶åˆè§¦å‘äº† âœ¨')
})

function f() { 
  console.log('eventA äº‹ä»¶æˆ‘åªè§¦å‘ä¸€æ¬¡');
}
e.once('type', f)
e.emit('type')
e.emit('type')
e.allOff('type')
e.emit('type')

// eventA äº‹ä»¶è§¦å‘
// âœ¨ eventA äº‹ä»¶åˆè§¦å‘äº† âœ¨
// eventA äº‹ä»¶æˆ‘åªè§¦å‘ä¸€æ¬¡
// eventA äº‹ä»¶è§¦å‘
// âœ¨ eventA äº‹ä»¶åˆè§¦å‘äº† âœ¨
```

## è¿­ä»£å™¨æ¨¡å¼

:::tip æ¦‚å¿µ

è¿­ä»£å™¨æ¨¡å¼ç®€å•çš„è¯´å°±æ˜¯æä¾›ä¸€ç§æ–¹æ³•é¡ºåºä¸€ä¸ªèšåˆå¯¹è±¡ä¸­å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚

:::

**è¿­ä»£å™¨æ¨¡å¼è§£å†³äº†ä»¥ä¸‹é—®é¢˜ï¼š**

- æä¾›ä¸€è‡´çš„éå†å„ç§æ•°æ®ç»“æ„çš„æ–¹å¼ï¼Œè€Œä¸ç”¨äº†è§£æ•°æ®çš„å†…éƒ¨ç»“æ„
- æä¾›éå†å®¹å™¨ï¼ˆé›†åˆï¼‰çš„èƒ½åŠ›è€Œæ— éœ€æ”¹å˜å®¹å™¨çš„æ¥å£

**ä¸€ä¸ªè¿­ä»£å™¨é€šå¸¸éœ€è¦å®ç°ä»¥ä¸‹æ¥å£ï¼š**

- `hasNext()`ï¼šåˆ¤æ–­è¿­ä»£æ˜¯å¦ç»“æŸï¼Œè¿”å›`Boolean`
- `next()`ï¼šæŸ¥æ‰¾å¹¶è¿”å›ä¸‹ä¸€ä¸ªå…ƒç´ 

ä¸‹é¢ä¸º`Javascript`çš„æ•°ç»„å®ç°ä¸€ä¸ªè¿­ä»£å™¨å¯ä»¥è¿™ä¹ˆå†™ï¼š

```js
const item = [1, 'red', false, 3.14];

function Iterator(items) {
  this.items = items;
  this.index = 0;
}

Iterator.prototype = {
  hasNext: function () {
    return this.index < this.items.length;
  },
  next: function () {
    return this.items[this.index++];
  }
}
```

éªŒè¯ä¸€ä¸‹è¿­ä»£å™¨æ˜¯å¦å·¥ä½œï¼š

```js
const iterator = new Iterator(item);

while(iterator.hasNext()){
  console.log(iterator.next());
}
//è¾“å‡ºï¼š1, red, false, 3.14
```

> ES6æä¾›äº†æ›´ç®€å•çš„è¿­ä»£å¾ªç¯è¯­æ³• `for...of`ï¼Œä½¿ç”¨è¯¥è¯­æ³•çš„å‰ææ˜¯æ“ä½œå¯¹è±¡éœ€è¦å®ç° å¯è¿­ä»£åè®®ï¼ˆ`The iterable protocol`ï¼‰ï¼Œç®€å•è¯´å°±æ˜¯è¯¥å¯¹è±¡æœ‰ä¸ª`Key`ä¸º `Symbol.iterator` çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª`iterator`å¯¹è±¡ã€‚

æ¯”å¦‚æˆ‘ä»¬å®ç°ä¸€ä¸ª Range ç±»ç”¨äºåœ¨æŸä¸ªæ•°å­—åŒºé—´è¿›è¡Œè¿­ä»£ï¼š

```js
function Range(start, end) {
  return {
    [Symbol.iterator]: function () {
      return {
        next() {
          if (start < end) {
            return { value: start++, done: false };
          }
          return { done: true, value: end };
        }
      }
    }
  }
}
```

éªŒè¯ä¸€ä¸‹ï¼š

```js
for (num of Range(1, 5)) {
  console.log(num);
}
// è¾“å‡ºï¼š1, 2, 3, 4
```

## ä¸­ä»‹è€…æ¨¡å¼

- åœ¨ä¸­ä»‹è€…æ¨¡å¼ä¸­ï¼Œä¸­ä»‹è€…ï¼ˆ`Mediator`ï¼‰åŒ…è£…äº†ä¸€ç³»åˆ—å¯¹è±¡ç›¸äº’ä½œç”¨çš„æ–¹å¼ï¼Œä½¿å¾—è¿™äº›å¯¹è±¡ä¸å¿…ç›´æ¥ç›¸äº’ä½œç”¨ï¼Œè€Œæ˜¯ç”±ä¸­ä»‹è€…åè°ƒå®ƒä»¬ä¹‹é—´çš„äº¤äº’ï¼Œä»è€Œä½¿å®ƒä»¬å¯ä»¥æ¾æ•£å¶åˆã€‚å½“æŸäº›å¯¹è±¡ä¹‹é—´çš„ä½œç”¨å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä¸ä¼šç«‹å³å½±å“å…¶ä»–çš„ä¸€äº›å¯¹è±¡ä¹‹é—´çš„ä½œç”¨ï¼Œä¿è¯è¿™äº›ä½œç”¨å¯ä»¥å½¼æ­¤ç‹¬ç«‹çš„å˜åŒ–ã€‚
- ä¸­ä»‹è€…æ¨¡å¼å’Œè§‚å¯Ÿè€…æ¨¡å¼æœ‰ä¸€å®šçš„ç›¸ä¼¼æ€§ï¼Œéƒ½æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œä¹Ÿéƒ½æ˜¯é›†ä¸­å¼é€šä¿¡ï¼Œä¸åŒçš„æ˜¯ä¸­ä»‹è€…æ¨¡å¼æ˜¯å¤„ç†åŒçº§å¯¹è±¡ä¹‹é—´çš„äº¤äº’ï¼Œè€Œè§‚å¯Ÿè€…æ¨¡å¼æ˜¯å¤„ç†`Observer`å’Œ`Subject`ä¹‹é—´çš„äº¤äº’ã€‚ä¸­ä»‹è€…æ¨¡å¼æœ‰äº›åƒå©šæ‹ä¸­ä»‹ï¼Œç›¸äº²å¯¹è±¡åˆšå¼€å§‹å¹¶ä¸èƒ½ç›´æ¥äº¤æµï¼Œè€Œæ˜¯è¦é€šè¿‡ä¸­ä»‹å»ç­›é€‰åŒ¹é…å†å†³å®šè°å’Œè°è§é¢ã€‚

**åœºæ™¯**

> ä¾‹å¦‚è´­ç‰©è½¦éœ€æ±‚ï¼Œå­˜åœ¨å•†å“é€‰æ‹©è¡¨å•ã€é¢œè‰²é€‰æ‹©è¡¨å•ã€è´­ä¹°æ•°é‡è¡¨å•ç­‰ç­‰ï¼Œéƒ½ä¼šè§¦å‘`change`äº‹ä»¶ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡ä¸­ä»‹è€…æ¥è½¬å‘å¤„ç†è¿™äº›äº‹ä»¶ï¼Œå®ç°å„ä¸ªäº‹ä»¶é—´çš„è§£è€¦ï¼Œä»…ä»…ç»´æŠ¤ä¸­ä»‹è€…å¯¹è±¡å³å¯ã€‚

```js
var goods = {   //æ‰‹æœºåº“å­˜
    'red|32G': 3,
    'red|64G': 1,
    'blue|32G': 7,
    'blue|32G': 6,
};
//ä¸­ä»‹è€…
var mediator = (function() {
    var colorSelect = document.getElementById('colorSelect');
    var memorySelect = document.getElementById('memorySelect');
    var numSelect = document.getElementById('numSelect');
    return {
        changed: function(obj) {
            switch(obj){
                case colorSelect:
                    //TODO
                    break;
                case memorySelect:
                    //TODO
                    break;
                case numSelect:
                    //TODO
                    break;
            }
        }
    }
})();
colorSelect.onchange = function() {
    mediator.changed(this);
};
memorySelect.onchange = function() {
    mediator.changed(this);
};
numSelect.onchange = function() {
    mediator.changed(this);
};
```

- èŠå¤©å®¤é‡Œ

èŠå¤©å®¤æˆå‘˜ç±»ï¼š

```js
function Member(name) {
  this.name = name;
  this.chatroom = null;
}

Member.prototype = {
  // å‘é€æ¶ˆæ¯
  send: function (message, toMember) {
    this.chatroom.send(message, this, toMember);
  },
  // æ¥æ”¶æ¶ˆæ¯
  receive: function (message, fromMember) {
    console.log(`${fromMember.name} to ${this.name}: ${message}`);
  }
}
```

**èŠå¤©å®¤ç±»ï¼š**

```js
function Chatroom() {
  this.members = {};
}

Chatroom.prototype = {
  // å¢åŠ æˆå‘˜
  addMember: function (member) {
    this.members[member.name] = member;
    member.chatroom = this;
  },
  // å‘é€æ¶ˆæ¯
  send: function (message, fromMember, toMember) {
    toMember.receive(message, fromMember);
  }
}
```

**æµ‹è¯•ä¸€ä¸‹ï¼š**

```js
const chatroom = new Chatroom();
const bruce = new Member('bruce');
const frank = new Member('frank');

chatroom.addMember(bruce);
chatroom.addMember(frank);

bruce.send('Hey frank', frank);

//è¾“å‡ºï¼šbruce to frank: hello frank
```

**ä¼˜ç‚¹**

- ä½¿å„å¯¹è±¡ä¹‹é—´è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’
- ä¸­ä»‹è€…å’Œå¯¹è±¡ä¸€å¯¹å¤šçš„å…³ç³»å–ä»£äº†å¯¹è±¡ä¹‹é—´çš„ç½‘çŠ¶å¤šå¯¹å¤šçš„å…³ç³»
- å¦‚æœå¯¹è±¡ä¹‹é—´çš„å¤æ‚è€¦åˆåº¦å¯¼è‡´ç»´æŠ¤å¾ˆå›°éš¾ï¼Œè€Œä¸”è€¦åˆåº¦éšé¡¹ç›®å˜åŒ–å¢é€Ÿå¾ˆå¿«ï¼Œå°±éœ€è¦ä¸­ä»‹è€…é‡æ„ä»£ç 

**ç¼ºç‚¹**

> ç³»ç»Ÿä¸­ä¼šæ–°å¢ä¸€ä¸ªä¸­ä»‹è€…å¯¹è±¡ï¼Œå› ä¸ºå¯¹è±¡ä¹‹é—´äº¤äº’çš„å¤æ‚æ€§ï¼Œè½¬ç§»æˆäº†ä¸­ä»‹è€…å¯¹è±¡çš„å¤æ‚æ€§ï¼Œä½¿å¾—ä¸­ä»‹è€…å¯¹è±¡ç»å¸¸æ˜¯å·¨å¤§çš„ã€‚ä¸­ä»‹ è€…å¯¹è±¡è‡ªèº«å¾€å¾€å°±æ˜¯ä¸€ä¸ªéš¾ä»¥ç»´æŠ¤çš„å¯¹è±¡ã€‚

## è®¿é—®è€…æ¨¡å¼

:::tip æ¦‚å¿µ

è®¿é—®è€…æ¨¡å¼ æ˜¯ä¸€ç§å°†ç®—æ³•ä¸å¯¹è±¡ç»“æ„åˆ†ç¦»çš„è®¾è®¡æ¨¡å¼ï¼Œé€šä¿—ç‚¹è®²å°±æ˜¯ï¼šè®¿é—®è€…æ¨¡å¼è®©æˆ‘ä»¬èƒ½å¤Ÿåœ¨ä¸æ”¹å˜ä¸€ä¸ªå¯¹è±¡ç»“æ„çš„å‰æä¸‹èƒ½å¤Ÿç»™è¯¥å¯¹è±¡å¢åŠ æ–°çš„é€»è¾‘ï¼Œæ–°å¢çš„é€»è¾‘ä¿å­˜åœ¨ä¸€ä¸ªç‹¬ç«‹çš„è®¿é—®è€…å¯¹è±¡ä¸­ã€‚è®¿é—®è€…æ¨¡å¼å¸¸ç”¨äºæ‹“å±•ä¸€äº›ç¬¬ä¸‰æ–¹çš„åº“å’Œå·¥å…·ã€‚

:::

```js
// è®¿é—®è€…  
class Visitor {
    constructor() {}
    visitConcreteElement(ConcreteElement) {
        ConcreteElement.operation()
    }
}
// å…ƒç´ ç±»  
class ConcreteElement{
    constructor() {
    }
    operation() {
       console.log("ConcreteElement.operation invoked");  
    }
    accept(visitor) {
        visitor.visitConcreteElement(this)
    }
}
// client
let visitor = new Visitor()
let element = new ConcreteElement()
elementA.accept(visitor)
```

**è®¿é—®è€…æ¨¡å¼çš„å®ç°æœ‰ä»¥ä¸‹å‡ ä¸ªè¦ç´ ï¼š**

- `Visitor Object`ï¼šè®¿é—®è€…å¯¹è±¡ï¼Œæ‹¥æœ‰ä¸€ä¸ª`visit()`æ–¹æ³•
- `Receiving Object`ï¼šæ¥æ”¶å¯¹è±¡ï¼Œæ‹¥æœ‰ä¸€ä¸ª `accept()` æ–¹æ³•
- `visit(receivingObj)`ï¼šç”¨äº`Visitor`æ¥æ”¶ä¸€ä¸ª`Receiving Object`
- `accept(visitor)`ï¼šç”¨äº`Receving Object`æ¥æ”¶ä¸€ä¸ª`Visitor`ï¼Œå¹¶é€šè¿‡è°ƒç”¨`Visitor`çš„ `visit()` ä¸ºå…¶æä¾›è·å–`Receiving Object`æ•°æ®çš„èƒ½åŠ›

ç®€å•çš„ä»£ç å®ç°å¦‚ä¸‹ï¼š

```js
Receiving Objectï¼š

function Employee(name, salary) {
  this.name = name;
  this.salary = salary;
}

Employee.prototype = {
  getSalary: function () {
    return this.salary;
  },
  setSalary: function (salary) {
    this.salary = salary;
  },
  accept: function (visitor) {
    visitor.visit(this);
  }
}
Visitor Objectï¼š

function Visitor() { }

Visitor.prototype = {
  visit: function (employee) {
    employee.setSalary(employee.getSalary() * 2);
  }
}
```

éªŒè¯ä¸€ä¸‹ï¼š

```js
const employee = new Employee('bruce', 1000);
const visitor = new Visitor();
employee.accept(visitor);

console.log(employee.getSalary());//è¾“å‡ºï¼š2000
```

åœºæ™¯

å¯¹è±¡ç»“æ„ä¸­å¯¹è±¡å¯¹åº”çš„ç±»å¾ˆå°‘æ”¹å˜ï¼Œä½†ç»å¸¸éœ€è¦åœ¨æ­¤å¯¹è±¡ç»“æ„ä¸Šå®šä¹‰æ–°çš„æ“ä½œ

éœ€è¦å¯¹ä¸€ä¸ªå¯¹è±¡ç»“æ„ä¸­çš„å¯¹è±¡è¿›è¡Œå¾ˆå¤šä¸åŒçš„å¹¶ä¸”ä¸ç›¸å…³çš„æ“ä½œï¼Œè€Œéœ€è¦é¿å…è®©è¿™äº›æ“ä½œ"æ±¡æŸ“"è¿™äº›å¯¹è±¡çš„ç±»ï¼Œä¹Ÿä¸å¸Œæœ›åœ¨å¢åŠ æ–°æ“ä½œæ—¶ä¿®æ”¹è¿™äº›ç±»ã€‚

**ä¼˜ç‚¹**

- ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™
- ä¼˜ç§€çš„æ‰©å±•æ€§
- çµæ´»æ€§

**ç¼ºç‚¹**

- å…·ä½“å…ƒç´ å¯¹è®¿é—®è€…å…¬å¸ƒç»†èŠ‚ï¼Œè¿åäº†è¿ªç±³ç‰¹åŸåˆ™
- è¿åäº†ä¾èµ–å€’ç½®åŸåˆ™ï¼Œä¾èµ–äº†å…·ä½“ç±»ï¼Œæ²¡æœ‰ä¾èµ–æŠ½è±¡ã€‚
- å…·ä½“å…ƒç´ å˜æ›´æ¯”è¾ƒå›°éš¾
